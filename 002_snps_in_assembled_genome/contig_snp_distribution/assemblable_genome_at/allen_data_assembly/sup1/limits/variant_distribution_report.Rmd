---
output:
  html_document:
    fig_caption: yes
    theme: spacelab
    toc: no
---
# **plots of variant distribution along chromosome length**

Load libraries and the data
```{r setup, include=FALSE}
# load the required libraries and functions
library(knitr)
library(markdown)
#opts_chunk$set(dev = 'pdf')

# source custom R functions
source('~/git-hub-repos/shyamrallapalli/mutations_hts_noref/lib/ggplot_theme.R')
source('~/git-hub-repos/shyamrallapalli/mutations_hts_noref/lib/zero_ratio_adj.R')
source('~/git-hub-repos/shyamrallapalli/mutations_hts_noref/lib/lm_eqn_plot.R')


```

...     

...  		

#### 2Mb-10kb grouping of whole genome

```{r 2Mb-10kb, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="2000000-per10000bp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- tenkb$numhm/tenkb$numht
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"), se=FALSE) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), se=FALSE) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), se=FALSE) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(1000000), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...		

...  		

#### 2Mb-50kb grouping of whole genome

```{r 2Mb-50kb, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="2000000-per50000bp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- tenkb$numhm/tenkb$numht
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(1000000), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...	

...  		

#### 2Mb-100kb grouping of whole genome

```{r 2Mb-100kb, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="2000000-per100000bp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- tenkb$numhm/tenkb$numht
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(1000000), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...	


...  		

#### 5Mb-10kb grouping of whole genome

```{r 5Mb-10kb, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="5000000-per10000bp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- tenkb$numhm/tenkb$numht
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(2500000), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...		

...  		

#### 5Mb-100kb grouping of whole genome

```{r 5Mb-100kb, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="5000000-per100000bp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- tenkb$numhm/tenkb$numht
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(2500000), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...	

...  		

#### 5Mb-500kb grouping of whole genome

```{r 5Mb-500kb, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="5000000-per500000bp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- tenkb$numhm/tenkb$numht
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(2500000), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...	

...  		

#### 10Mb-10kb grouping of whole genome

```{r 10Mb-10kb, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="10000000-per10000bp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- tenkb$numhm/tenkb$numht
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(5000000), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...		

...  		

#### 10Mb-100kb grouping of whole genome

```{r 10Mb-100kb, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="10000000-per100000bp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- tenkb$numhm/tenkb$numht
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(5000000), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...	

...  		

#### 10Mb-500kb grouping of whole genome

```{r 10Mb-500kb, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="10000000-per500000bp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- tenkb$numhm/tenkb$numht
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(5000000), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...	

...  		

#### 20Mb-10kb grouping of whole genome

```{r 20Mb-10kb, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="20000000-per10000bp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- tenkb$numhm/tenkb$numht
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(5305490), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...		


...  		

#### 20Mb-100kb grouping of whole genome

```{r 20Mb-100kb, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="20000000-per100000bp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- tenkb$numhm/tenkb$numht
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(5305490), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...	


...  		

#### 20Mb-500kb grouping of whole genome

```{r 20Mb-500kb, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="20000000-per500000bp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- tenkb$numhm/tenkb$numht
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(5305490), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...	

...  		

#### 2Mb-assembly grouping

```{r 2Mb-assembly, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="2000000-perassemblybp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- tenkb$numhm/tenkb$numht
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity", position="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(1000000), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...	

...  		

#### 2Mb-assembly  grouping

```{r 2Mb-assembly-ratio, echo=FALSE, fig.width=12, fig.height=6}
tenkb$ratio <- tenkb$ratio/tenkb$length
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity", position="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(1000000), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...	


...  		

#### 5Mb-assembly grouping

```{r 5Mb-assembly, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="5000000-perassemblybp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- (tenkb$numhm/tenkb$numht)/tenkb$length
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity", position="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(2500000), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...	

...  		

#### 10Mb-assembly grouping

```{r 10Mb-assembly, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="10000000-perassemblybp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- (tenkb$numhm/tenkb$numht)/tenkb$length
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity", position="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(5000000), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...	

...  		

#### 20Mb-assembly grouping

```{r 20Mb-assembly, echo=FALSE, fig.width=12, fig.height=6}
tenkb <- read.delim(file="20000000-perassemblybp-filtered_sup1_colT_wsT.vcf.txt", header = TRUE)
tenkb <- re_zero_ratio(tenkb, 0.01)
tenkb$ratio <- (tenkb$numhm/tenkb$numht)/tenkb$length
ggplot(data=tenkb, aes(x=position)) + stat_smooth(aes(y=ratio/sum(ratio), colour="homozygous to heterozygous ratio"),
                                                  method="lm", se=TRUE, fill=NA, formula=y ~ poly(x, 4, raw=TRUE) ) +
  geom_bar(aes(y=ratio/sum(ratio)), stat="identity", position="identity") +
  stat_smooth(aes(y=numhm/sum(numhm), colour="homozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  stat_smooth(aes(y=numht/sum(numht), colour="heterozygous variants"), method="lm", se=FALSE, formula=y ~ poly(x, 4, raw=TRUE) ) +
  scale_y_sqrt() + labs(y=NULL, main="genome in 10 KB fragment chunks") + mytheme +
  geom_vline(xintercept = as.numeric(5305490), size=0.5, linetype = "longdash") +
  annotate("text", x=Inf, y=Inf, label=lm_eqn(tenkb$position, tenkb$ratio, 4), hjust=1, vjust=1, size=8, family="Times", face="italic", parse=TRUE)


```


...

